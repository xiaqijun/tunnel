# ğŸ”§ ä¿®å¤ GitHub Actions 403 æƒé™é”™è¯¯

## é—®é¢˜è¯´æ˜

GitHub Actions åœ¨åˆ›å»º Release æ—¶é‡åˆ° 403 é”™è¯¯ï¼Œè¿™æ˜¯å› ä¸º `GITHUB_TOKEN` æ²¡æœ‰è¶³å¤Ÿçš„æƒé™ã€‚

## âœ… è§£å†³æ–¹æ¡ˆ

### æ–¹æ³• 1ï¼šä¿®æ”¹ GitHub ä»“åº“è®¾ç½®ï¼ˆæ¨èï¼‰â­

1. **æ‰“å¼€ä»“åº“è®¾ç½®**
   - è®¿é—®ï¼šhttps://github.com/xiaqijun/tunnel/settings/actions
   - æˆ–è€…ï¼šä»“åº“é¡µé¢ â†’ Settings â†’ Actions â†’ General

2. **é…ç½® Workflow æƒé™**
   
   æ‰¾åˆ° "Workflow permissions" éƒ¨åˆ†ï¼Œé€‰æ‹©ï¼š
   
   ```
   âœ… Read and write permissions
   ```
   
   **ç¡®ä¿å‹¾é€‰ï¼š**
   ```
   âœ… Allow GitHub Actions to create and approve pull requests
   ```

3. **ä¿å­˜è®¾ç½®**
   
   ç‚¹å‡»é¡µé¢åº•éƒ¨çš„ **Save** æŒ‰é’®

### æ–¹æ³• 2ï¼šå·²åœ¨ Workflow ä¸­æ·»åŠ æƒé™ï¼ˆå·²å®Œæˆï¼‰

æˆ‘å·²ç»åœ¨ workflow æ–‡ä»¶ä¸­æ·»åŠ äº†æ˜ç¡®çš„æƒé™å£°æ˜ï¼š

```yaml
# .github/workflows/release.yml
permissions:
  contents: write
```

---

## ğŸš€ é‡æ–°è§¦å‘æ„å»º

å®Œæˆä¸Šè¿°è®¾ç½®åï¼Œé‡æ–°è§¦å‘æ„å»ºï¼š

### æ­¥éª¤ 1ï¼šåˆ é™¤æ—§çš„ tag

```powershell
# åˆ é™¤æœ¬åœ° tag
git tag -d v1.0.0

# åˆ é™¤è¿œç¨‹ tag
git push origin :refs/tags/v1.0.0
```

### æ­¥éª¤ 2ï¼šåˆ é™¤å¤±è´¥çš„ Releaseï¼ˆå¯é€‰ï¼‰

è®¿é—®ï¼šhttps://github.com/xiaqijun/tunnel/releases

å¦‚æœçœ‹åˆ°å¤±è´¥çš„ v1.0.0 releaseï¼Œç‚¹å‡»åˆ é™¤ã€‚

### æ­¥éª¤ 3ï¼šé‡æ–°åˆ›å»º tag

```powershell
git tag -a v1.0.0 -m "Release v1.0.0

é«˜æ€§èƒ½å†…ç½‘ç©¿é€æœåŠ¡å™¨
- æ”¯æŒå¤šå¹³å°
- é¢„ç¼–è¯‘äºŒè¿›åˆ¶
- ä¸€é”®éƒ¨ç½²"

# æ¨é€ tag
git push origin v1.0.0
```

---

## ğŸ§ª éªŒè¯ä¿®å¤

1. **æŸ¥çœ‹ Actions è¿è¡ŒçŠ¶æ€**
   
   https://github.com/xiaqijun/tunnel/actions

2. **æ£€æŸ¥ Release é¡µé¢**
   
   https://github.com/xiaqijun/tunnel/releases/tag/v1.0.0

3. **ç¡®è®¤æ„å»ºäº§ç‰©**
   
   åº”è¯¥çœ‹åˆ°ä»¥ä¸‹æ–‡ä»¶ï¼š
   - âœ… tunnel-linux-amd64.tar.gz
   - âœ… tunnel-linux-arm64.tar.gz
   - âœ… tunnel-windows-amd64.zip
   - âœ… tunnel-darwin-amd64.tar.gz
   - âœ… tunnel-darwin-arm64.tar.gz

---

## ğŸ“‹ å¿«é€Ÿä¿®å¤è„šæœ¬

æˆ‘å·²ç»ä¸ºæ‚¨å‡†å¤‡å¥½äº†è‡ªåŠ¨åŒ–è„šæœ¬ï¼Œåœ¨ Windows PowerShell ä¸­è¿è¡Œï¼š

```powershell
# è¿è¡Œä¿®å¤è„šæœ¬
.\fix-and-retag.bat
```

---

## â“ å¸¸è§é—®é¢˜

### Q: ä¸ºä»€ä¹ˆä¼šå‡ºç° 403 é”™è¯¯ï¼Ÿ

**A:** GitHub åœ¨ 2023 å¹´æ›´æ–°äº†é»˜è®¤çš„ GITHUB_TOKEN æƒé™ç­–ç•¥ï¼Œæ–°ä»“åº“é»˜è®¤æ˜¯åªè¯»æƒé™ã€‚éœ€è¦æ‰‹åŠ¨å¼€å¯å†™æƒé™ã€‚

### Q: ä¿®æ”¹è®¾ç½®åéœ€è¦é‡æ–°æ„å»ºå—ï¼Ÿ

**A:** æ˜¯çš„ï¼Œéœ€è¦åˆ é™¤æ—§ tagï¼Œé‡æ–°æ¨é€ tag æ¥è§¦å‘æ–°çš„æ„å»ºã€‚

### Q: å¯ä»¥åªä¿®æ”¹ workflow æ–‡ä»¶ä¸ä¿®æ”¹ä»“åº“è®¾ç½®å—ï¼Ÿ

**A:** ç†è®ºä¸Šå¯ä»¥ï¼Œä½†æ¨èä¸¤ä¸ªéƒ½é…ç½®ï¼Œç¡®ä¿ä¸‡æ— ä¸€å¤±ã€‚

---

## ğŸ”— ç›¸å…³é“¾æ¥

- [GitHub Actions æƒé™æ–‡æ¡£](https://docs.github.com/en/actions/security-guides/automatic-token-authentication)
- [ä»“åº“è®¾ç½®é¡µé¢](https://github.com/xiaqijun/tunnel/settings/actions)
- [Actions è¿è¡Œè®°å½•](https://github.com/xiaqijun/tunnel/actions)

---

## ä¸‹ä¸€æ­¥

1. âœ… å·²ä¿®æ”¹ workflow æ–‡ä»¶ï¼ˆæ·»åŠ æƒé™å£°æ˜ï¼‰
2. â³ éœ€è¦æ‚¨åœ¨ GitHub è®¾ç½®ä¸­å¼€å¯å†™æƒé™
3. â³ åˆ é™¤å¹¶é‡æ–°åˆ›å»º v1.0.0 tag
4. â³ ç­‰å¾…æ„å»ºå®Œæˆï¼ˆ2-3åˆ†é’Ÿï¼‰
5. â³ éƒ¨ç½²åˆ°æœåŠ¡å™¨

æŒ‰ç…§ä¸Šé¢çš„æ­¥éª¤æ“ä½œå³å¯ï¼ğŸš€
