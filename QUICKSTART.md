# å¿«é€Ÿå¼€å§‹æŒ‡å—

æ¬¢è¿ä½¿ç”¨ Tunnel å†…ç½‘ç©¿é€æœåŠ¡å™¨ï¼æœ¬æŒ‡å—å°†å¸®åŠ©ä½ åœ¨ 5 åˆ†é’Ÿå†…å¯åŠ¨å¹¶è¿è¡Œã€‚

## ğŸ“‹ å‰ç½®è¦æ±‚

- Go 1.21 æˆ–æ›´é«˜ç‰ˆæœ¬
- Windows/Linux/macOS æ“ä½œç³»ç»Ÿ
- åŸºæœ¬çš„ç½‘ç»œçŸ¥è¯†

## ğŸš€ å¿«é€Ÿå¯åŠ¨ (Windows)

### æ–¹å¼ 1: ä½¿ç”¨å¯åŠ¨è„šæœ¬ (æ¨è)

1. åŒå‡»è¿è¡Œ `start.bat`
2. é€‰æ‹©é€‰é¡¹:
   - `1` - ä»…è¿è¡ŒæœåŠ¡å™¨
   - `2` - ä»…è¿è¡Œå®¢æˆ·ç«¯  
   - `3` - åŒæ—¶è¿è¡ŒæœåŠ¡å™¨å’Œå®¢æˆ·ç«¯
3. å®Œæˆï¼è®¿é—® http://localhost:8080 æŸ¥çœ‹ç®¡ç†ç•Œé¢

### æ–¹å¼ 2: æ‰‹åŠ¨ç¼–è¯‘è¿è¡Œ

```cmd
# 1. ç¼–è¯‘
build.bat

# 2. è¿è¡ŒæœåŠ¡å™¨ (æ–°ç»ˆç«¯çª—å£)
bin\tunnel-server.exe -config config.yaml

# 3. è¿è¡Œå®¢æˆ·ç«¯ (æ–°ç»ˆç«¯çª—å£)
bin\tunnel-client.exe -config client-config.yaml
```

## ğŸ§ å¿«é€Ÿå¯åŠ¨ (Linux/Mac)

```bash
# 1. å®‰è£…ä¾èµ–
make deps

# 2. ç¼–è¯‘
make build

# 3. è¿è¡ŒæœåŠ¡å™¨ (ç»ˆç«¯ 1)
./bin/tunnel-server -config config.yaml

# 4. è¿è¡Œå®¢æˆ·ç«¯ (ç»ˆç«¯ 2)
./bin/tunnel-client -config client-config.yaml
```

## âš™ï¸ åŸºç¡€é…ç½®

### æœåŠ¡å™¨é…ç½® (config.yaml)

```yaml
server:
  bind_addr: "0.0.0.0"
  bind_port: 7000        # å®¢æˆ·ç«¯è¿æ¥ç«¯å£
  
web:
  bind_addr: "0.0.0.0"
  bind_port: 8080        # Web ç®¡ç†ç•Œé¢ç«¯å£
  
auth:
  token: "your-secret-token"  # ä¿®æ”¹ä¸ºå¼ºå¯†ç ï¼
```

### å®¢æˆ·ç«¯é…ç½® (client-config.yaml)

```yaml
server:
  addr: "localhost:7000"      # æœåŠ¡å™¨åœ°å€
  token: "your-secret-token"  # ä¸æœåŠ¡å™¨ä¿æŒä¸€è‡´
  
tunnels:
  - name: "my-web-service"
    local_addr: "127.0.0.1"
    local_port: 8080          # æœ¬åœ°æœåŠ¡ç«¯å£
    remote_port: 8000         # è¿œç¨‹è®¿é—®ç«¯å£
```

## ğŸ“Š éªŒè¯è¿è¡Œ

### 1. æ£€æŸ¥æœåŠ¡å™¨æ—¥å¿—

ä½ åº”è¯¥çœ‹åˆ°ç±»ä¼¼è¾“å‡ºï¼š

```
Tunnel server listening on 0.0.0.0:7000
Web API listening on http://0.0.0.0:8080
Client connected: client-1 (1706861234567890123)
Tunnel started: 0.0.0.0:8000 -> client-1:8080
```

### 2. è®¿é—® Web ç®¡ç†ç•Œé¢

æ‰“å¼€æµè§ˆå™¨è®¿é—®: http://localhost:8080

ä½ åº”è¯¥èƒ½çœ‹åˆ°:
- âœ… åœ¨çº¿å®¢æˆ·ç«¯æ•°é‡
- âœ… æ´»åŠ¨è¿æ¥ç»Ÿè®¡
- âœ… æµé‡æ•°æ®
- âœ… éš§é“åˆ—è¡¨

### 3. æµ‹è¯•éš§é“

å¦‚æœä½ é…ç½®äº†ç«¯å£ 8000 -> 8080 çš„éš§é“ï¼š

```bash
# åœ¨æœ¬åœ°å¯åŠ¨ä¸€ä¸ªæµ‹è¯•æœåŠ¡ (ç«¯å£ 8080)
python -m http.server 8080

# é€šè¿‡éš§é“è®¿é—®
curl http://localhost:8000
```

## ğŸŒ å¤–ç½‘è®¿é—®

### 1. ä¿®æ”¹æœåŠ¡å™¨é…ç½®

å°†æœåŠ¡å™¨éƒ¨ç½²åˆ°äº‘æœåŠ¡å™¨ï¼Œé…ç½®å…¬ç½‘ IPï¼š

```yaml
server:
  bind_addr: "0.0.0.0"
  bind_port: 7000
```

### 2. é…ç½®é˜²ç«å¢™

å¼€æ”¾ç«¯å£:
- 7000 (å®¢æˆ·ç«¯è¿æ¥)
- 8080 (Web ç®¡ç†)
- 8000-9000 (éš§é“ç«¯å£èŒƒå›´)

### 3. ä¿®æ”¹å®¢æˆ·ç«¯é…ç½®

```yaml
server:
  addr: "your-server-ip:7000"  # æ›¿æ¢ä¸ºæœåŠ¡å™¨å…¬ç½‘ IP
```

### 4. æµ‹è¯•å¤–ç½‘è®¿é—®

```bash
# é€šè¿‡å…¬ç½‘è®¿é—®ä½ çš„æœ¬åœ°æœåŠ¡
curl http://your-server-ip:8000
```

## ğŸ’¡ å¸¸è§åœºæ™¯

### åœºæ™¯ 1: ä¸´æ—¶å±•ç¤ºæœ¬åœ°ç½‘ç«™

```yaml
# æœ¬åœ°è¿è¡Œ: npm run dev (ç«¯å£ 3000)
tunnels:
  - name: "my-app"
    local_port: 3000
    remote_port: 8000

# åˆ†äº«é“¾æ¥: http://your-server-ip:8000
```

### åœºæ™¯ 2: è¿œç¨‹è®¿é—®å®¶åº­ NAS

```yaml
tunnels:
  - name: "nas-web"
    local_addr: "192.168.1.100"  # NAS IP
    local_port: 5000
    remote_port: 9000

# è®¿é—®: http://your-server-ip:9000
```

### åœºæ™¯ 3: å¼€å‘å¾®ä¿¡å…¬ä¼—å·

```yaml
tunnels:
  - name: "wechat-dev"
    local_port: 80
    remote_port: 8000

# å¾®ä¿¡åå°é…ç½®: http://your-server-ip:8000/wechat
```

## ğŸ”§ æ•…éšœæ’é™¤

### é—®é¢˜: å®¢æˆ·ç«¯æ— æ³•è¿æ¥

**æ£€æŸ¥æ¸…å•:**
- âœ… æœåŠ¡å™¨æ˜¯å¦æ­£åœ¨è¿è¡Œï¼Ÿ
- âœ… token æ˜¯å¦ä¸€è‡´ï¼Ÿ
- âœ… ç½‘ç»œæ˜¯å¦å¯è¾¾ï¼Ÿ
- âœ… é˜²ç«å¢™æ˜¯å¦å¼€æ”¾ï¼Ÿ

```bash
# æµ‹è¯•ç½‘ç»œè¿æ¥
ping your-server-ip
telnet your-server-ip 7000
```

### é—®é¢˜: Web ç•Œé¢æ— æ³•è®¿é—®

```bash
# æ£€æŸ¥ç«¯å£å ç”¨
netstat -ano | findstr :8080

# å°è¯•æ›´æ¢ç«¯å£
web:
  bind_port: 8081
```

### é—®é¢˜: éš§é“ä¸å·¥ä½œ

**æ£€æŸ¥æœ¬åœ°æœåŠ¡:**
```bash
# ç¡®è®¤æœ¬åœ°æœåŠ¡è¿è¡Œ
curl http://localhost:8080

# æ£€æŸ¥ç«¯å£æ˜¯å¦è¢«å ç”¨
netstat -ano | findstr :8000
```

## ğŸ“š ä¸‹ä¸€æ­¥

- ğŸ“– é˜…è¯» [DEPLOY.md](DEPLOY.md) äº†è§£ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²
- ğŸš€ æŸ¥çœ‹ [PERFORMANCE.md](PERFORMANCE.md) è¿›è¡Œæ€§èƒ½ä¼˜åŒ–
- ğŸ”Œ å‚è€ƒ [API.md](API.md) é›†æˆåˆ°ä½ çš„ç³»ç»Ÿ
- ğŸ’¬ é‡åˆ°é—®é¢˜ï¼ŸæŸ¥çœ‹æ—¥å¿—æˆ–æäº¤ Issue

## ğŸ‰ æˆåŠŸï¼

æ­å–œï¼ä½ å·²ç»æˆåŠŸè¿è¡Œäº† Tunnel å†…ç½‘ç©¿é€æœåŠ¡å™¨ã€‚

äº«å—ä½ çš„å†…ç½‘ç©¿é€ä¹‹æ—…å§ï¼ ğŸš€
